# ML307R 4Gæ¨¡å—é€šè®¯é—®é¢˜åˆ†æžä¸Žä¿®å¤è®°å½•

## æ–‡æ¡£ä¿¡æ¯

- **åˆ›å»ºæ—¥æœŸ**: 2025-11-12
- **é¡¹ç›®**: aibox_s3 (ç«‹åˆ›å¼€å‘æ¿)
- **é—®é¢˜**: ML307R 4Gæ¨¡å—æ— æ³•å“åº”ATæŒ‡ä»¤
- **çŠ¶æ€**: âœ… å·²è§£å†³

---

## ç›®å½•

1. [é—®é¢˜æè¿°](#1-é—®é¢˜æè¿°)
2. [ç¡¬ä»¶é…ç½®](#2-ç¡¬ä»¶é…ç½®)
3. [é—®é¢˜çŽ°è±¡](#3-é—®é¢˜çŽ°è±¡)
4. [åˆ†æžè¿‡ç¨‹](#4-åˆ†æžè¿‡ç¨‹)
5. [æ ¹æœ¬åŽŸå› ](#5-æ ¹æœ¬åŽŸå› )
6. [ä¿®å¤æ–¹æ¡ˆ](#6-ä¿®å¤æ–¹æ¡ˆ)
7. [éªŒè¯ç»“æžœ](#7-éªŒè¯ç»“æžœ)
8. [ç»éªŒæ€»ç»“](#8-ç»éªŒæ€»ç»“)

---

## 1. é—®é¢˜æè¿°

### 1.1 èƒŒæ™¯

åœ¨ç«‹åˆ›å¼€å‘æ¿ï¼ˆlichuang-devï¼‰é¡¹ç›®ä¸­æ·»åŠ ML307R 4Gæ¨¡å—æ”¯æŒï¼Œå®žçŽ°WiFiå’Œ4Gç½‘ç»œçš„æ™ºèƒ½åˆ‡æ¢åŠŸèƒ½ã€‚ç¡¬ä»¶è¿žæŽ¥å®ŒæˆåŽï¼Œå‘çŽ°ML307Ræ¨¡å—æ— æ³•å“åº”ATæŒ‡ä»¤ï¼Œæ³¢ç‰¹çŽ‡æ£€æµ‹ä¸€ç›´å¤±è´¥ã€‚

### 1.2 ç›®æ ‡

- å®žçŽ°ML307R 4Gæ¨¡å—çš„æ­£å¸¸é€šè®¯
- æˆåŠŸæ£€æµ‹æ³¢ç‰¹çŽ‡å¹¶å»ºç«‹ATæŒ‡ä»¤é€šè®¯
- å®žçŽ°ç½‘ç»œæ³¨å†Œå’Œæ•°æ®è¿žæŽ¥

---

## 2. ç¡¬ä»¶é…ç½®

### 2.1 å¼•è„šè¿žæŽ¥

| ESP32-S3å¼•è„š | ML307Rå¼•è„š | åŠŸèƒ½ | è¯´æ˜Ž |
|-------------|-----------|------|------|
| GPIO5 | RESET | å¤ä½æŽ§åˆ¶ | é«˜ç”µå¹³å¤ä½ï¼Œä½Žç”µå¹³æ­£å¸¸å·¥ä½œ |
| GPIO17 | UART_RXD | UART TX | ESP32å‘é€ â†’ ML307RæŽ¥æ”¶ |
| GPIO18 | UART_TXD | UART RX | ESP32æŽ¥æ”¶ â† ML307Rå‘é€ |
| VCC | VCC | ç”µæº | 3.3V~4.2V |
| GND | GND | åœ° | - |

### 2.2 é…ç½®æ–‡ä»¶

**æ–‡ä»¶**: `main/boards/lichuang-dev/config.h`

```c
// ML307R 4Gæ¨¡å—é…ç½®
#define ML307_ENABLE 1
#define ML307_RST_PIN              GPIO_NUM_5
#define ML307_TX_PIN               GPIO_NUM_17  // ESP32 TX -> ML307 RX
#define ML307_RX_PIN               GPIO_NUM_18  // ESP32 RX <- ML307 TX
#define ML307_DTR_PIN              GPIO_NUM_NC
```

### 2.3 UARTé…ç½®

- **UARTç«¯å£**: UART_NUM_1
- **æ³¢ç‰¹çŽ‡**: è‡ªåŠ¨æ£€æµ‹ï¼ˆå°è¯•8ç§ï¼š115200, 921600, 460800, 230400, 57600, 38400, 19200, 9600ï¼‰
- **æ•°æ®ä½**: 8ä½
- **åœæ­¢ä½**: 1ä½
- **æ ¡éªŒä½**: æ— 
- **æµæŽ§**: æ— 

---

## 3. é—®é¢˜çŽ°è±¡

### 3.1 åˆå§‹å¯åŠ¨æ—¥å¿—ï¼ˆä¿®å¤å‰ï¼‰

```
I (239) SmartDualNetworkBoard: ML307 reset pin (GPIO5) initialized to LOW (WiFi mode)
I (249) SmartDualNetworkBoard: ðŸŒ Initialize ML307 4G board
I (759) AtUart: Detecting baud rate...
I (1919) AtUart: Detecting baud rate...
I (3079) AtUart: Detecting baud rate...
I (4239) AtUart: Detecting baud rate...
...ï¼ˆæ— é™é‡å¤ï¼‰
```

### 3.2 çŽ°è±¡åˆ†æž

| è§‚å¯Ÿé¡¹ | çŽ°è±¡ | è¯´æ˜Ž |
|--------|------|------|
| æ—¥å¿—è¾“å‡º | `Detecting baud rate...` æ¯1160msé‡å¤ä¸€æ¬¡ | æ³¢ç‰¹çŽ‡æ£€æµ‹ä¸€ç›´å¤±è´¥ |
| å¤ä½å¼•è„š | GPIO5åˆå§‹åŒ–ä¸ºLOW | æ—¥å¿—æ˜¾ç¤º"WiFi mode" |
| ç½‘ç»œåˆå§‹åŒ– | æ˜¾ç¤º"Initialize ML307 4G board" | è¯´æ˜Žç½‘ç»œç±»åž‹æ˜¯ML307 |
| æ³¢ç‰¹çŽ‡æ£€æµ‹ | æ— æˆåŠŸæ—¥å¿— | æœªæ£€æµ‹åˆ°ä»»ä½•å“åº” |

### 3.3 ç¤ºæ³¢å™¨æµ‹é‡ç»“æžœ

| æµ‹é‡ç‚¹ | è§‚å¯Ÿç»“æžœ | è¯´æ˜Ž |
|--------|---------|------|
| **ML307Rçš„RXå¼•è„š** | âœ… æœ‰ä¸²å£æ³¢å½¢ | ESP32çš„GPIO17ï¼ˆTXï¼‰æ­£åœ¨å‘é€æ•°æ® |
| **ML307Rçš„TXå¼•è„š** | âŒ ä¸€ç›´æ˜¯é«˜ç”µå¹³ | ML307Ræ²¡æœ‰å‘é€ä»»ä½•æ•°æ® |
| **GPIO5å¤ä½å¼•è„š** | ä¸€ç›´ä¿æŒLOW | æ²¡æœ‰è§‚å¯Ÿåˆ°å¤ä½è„‰å†² |

**ç»“è®º**: 
- âœ… ESP32çš„UART TXå·¥ä½œæ­£å¸¸ï¼Œæ­£åœ¨å‘é€ATæŒ‡ä»¤
- âŒ ML307Ræ²¡æœ‰å“åº”ï¼ŒTXå¼•è„šæ— è¾“å‡º
- âŒ å¤ä½å¼•è„šæ²¡æœ‰æ‰§è¡Œå¤ä½æ—¶åº

---

## 4. åˆ†æžè¿‡ç¨‹

### 4.1 æ³¢ç‰¹çŽ‡æ£€æµ‹æœºåˆ¶åˆ†æž

**ä»£ç ä½ç½®**: `managed_components/78__esp-ml307/src/at_uart.cc`

```cpp
bool AtUart::DetectBaudRate() {
    int baud_rates[] = {115200, 921600, 460800, 230400, 57600, 38400, 19200, 9600};
    while (true) {
        ESP_LOGI(TAG, "Detecting baud rate...");
        for (size_t i = 0; i < 8; i++) {
            int rate = baud_rates[i];
            uart_set_baudrate(uart_num_, rate);
            if (SendCommand("AT", 20)) {  // å‘é€"AT\r\n"ï¼Œç­‰å¾…20ms
                ESP_LOGI(TAG, "Detected baud rate: %d", rate);
                baud_rate_ = rate;
                return true;
            }
        }
        vTaskDelay(pdMS_TO_TICKS(1000));  // æ‰€æœ‰æ³¢ç‰¹çŽ‡éƒ½å¤±è´¥åŽï¼Œç­‰å¾…1ç§’
    }
    return false;
}
```

**æ£€æµ‹æµç¨‹**:
1. å°è¯•8ç§æ³¢ç‰¹çŽ‡ï¼Œæ¯ç§æ³¢ç‰¹çŽ‡å‘é€`AT\r\n`ï¼Œç­‰å¾…20ms
2. å¦‚æžœæ”¶åˆ°`OK\r\n`å“åº”ï¼Œæ£€æµ‹æˆåŠŸ
3. å¦‚æžœæ‰€æœ‰æ³¢ç‰¹çŽ‡éƒ½å¤±è´¥ï¼Œç­‰å¾…1ç§’åŽé‡è¯•
4. æ—¶é—´é—´éš”ï¼š8Ã—20ms + 1000ms = 1160ms

**å‘é€çš„ATæŒ‡ä»¤**: åªå‘é€`AT\r\n`ï¼ˆHEX: 41 54 0D 0Aï¼‰

### 4.2 å¤ä½æ—¶åºä»£ç åˆ†æž

**ä»£ç ä½ç½®**: `main/boards/common/smart_dual_network_board.cc`

**ä¿®å¤å‰çš„ä»£ç **:

```cpp
SmartDualNetworkBoard::SmartDualNetworkBoard(...) 
    : Board(), 
      ml307_rst_pin_(ml307_rst_pin),
      ml307_tx_pin_(ml307_tx_pin), 
      ml307_rx_pin_(ml307_rx_pin), 
      ml307_dtr_pin_(ml307_dtr_pin) {
    
    // åˆå§‹åŒ–ML307å¤ä½å¼•è„š
    if (ml307_rst_pin_ != GPIO_NUM_NC) {
        gpio_reset_pin(ml307_rst_pin_);
        gpio_set_direction(ml307_rst_pin_, GPIO_MODE_OUTPUT);

        // ðŸŽ¯ åªåœ¨ML307æ¨¡å¼ä¸‹æ‰§è¡Œå¤ä½æ—¶åº
        if (network_type_ == NetworkType::ML307) {  // âŒ æ­¤æ—¶network_type_è¿˜æ˜¯é»˜è®¤å€¼WIFI
            // æ‰§è¡Œå¤ä½æ—¶åº
            gpio_set_level(ml307_rst_pin_, 1);
            vTaskDelay(pdMS_TO_TICKS(100));
            gpio_set_level(ml307_rst_pin_, 0);
            vTaskDelay(pdMS_TO_TICKS(5000));
        } else {
            // WiFiæ¨¡å¼ä¸‹ï¼Œä¿æŒå¤ä½å¼•è„šä¸ºä½Žç”µå¹³
            gpio_set_level(ml307_rst_pin_, 0);  // âœ… å®žé™…æ‰§è¡Œè¿™é‡Œ
            ESP_LOGI(TAG, "ML307 reset pin (GPIO%d) initialized to LOW (WiFi mode)", ml307_rst_pin_);
        }
    }
    
    // ä»ŽSettingsåŠ è½½ç½‘ç»œç±»åž‹
    network_type_ = LoadNetworkTypeFromSettings(default_net_type);  // âŒ æ­¤æ—¶æ‰åŠ è½½ï¼Œä½†å¤ä½æ—¶åºå·²ç»é”™è¿‡
    
    // åˆå§‹åŒ–å½“å‰ç½‘ç»œç±»åž‹å¯¹åº”çš„æ¿å¡
    InitializeCurrentBoard();
}
```

**é—®é¢˜åˆ†æž**:

1. **æˆå‘˜å˜é‡é»˜è®¤å€¼** (`main/boards/common/smart_dual_network_board.h`):
   ```cpp
   NetworkType network_type_ = NetworkType::WIFI;  // é»˜è®¤ä½¿ç”¨WiFi
   ```

2. **æ‰§è¡Œé¡ºåºé”™è¯¯**:
   ```
   æ­¥éª¤1: åˆå§‹åŒ–å¤ä½å¼•è„šï¼ˆæ­¤æ—¶network_type_ = WIFIï¼Œé»˜è®¤å€¼ï¼‰
          â†“
          åˆ¤æ–­: if (network_type_ == NetworkType::ML307)
          â†“
          ç»“æžœ: falseï¼Œæ‰§è¡Œelseåˆ†æ”¯
          â†“
          gpio_set_level(ml307_rst_pin_, 0);  // ç›´æŽ¥è®¾ç½®ä¸ºLOW
   
   æ­¥éª¤2: åŠ è½½ç½‘ç»œç±»åž‹
          â†“
          network_type_ = LoadNetworkTypeFromSettings(...)
          â†“
          ç»“æžœ: network_type_ = NetworkType::ML307
   
   æ­¥éª¤3: åˆå§‹åŒ–æ¿å¡
          â†“
          InitializeCurrentBoard();  // åˆ›å»ºMl307Boardå®žä¾‹
          â†“
          å¼€å§‹æ³¢ç‰¹çŽ‡æ£€æµ‹
          â†“
          âŒ ä½†å¤ä½æ—¶åºå·²ç»é”™è¿‡ï¼ŒML307Ræœªæ­£å¸¸å¯åŠ¨
   ```

3. **æ—¥å¿—éªŒè¯**:
   ```
   I (239) SmartDualNetworkBoard: ML307 reset pin (GPIO5) initialized to LOW (WiFi mode)
   ```
   - æ—¥å¿—æ˜¾ç¤º"WiFi mode"ï¼Œè¯´æ˜Žæ‰§è¡Œäº†elseåˆ†æ”¯
   - æ­¤æ—¶`network_type_`è¿˜æ˜¯é»˜è®¤çš„WIFI
   - å¤ä½å¼•è„šè¢«ç›´æŽ¥è®¾ç½®ä¸ºLOWï¼Œæ²¡æœ‰æ‰§è¡Œå¤ä½è„‰å†²

---

## 5. æ ¹æœ¬åŽŸå› 

### 5.1 é—®é¢˜æ ¹æº

**ä»£ç é€»è¾‘é¡ºåºé”™è¯¯å¯¼è‡´å¤ä½æ—¶åºæœªæ‰§è¡Œ**

- âŒ æž„é€ å‡½æ•°ä¸­ï¼Œå¤ä½å¼•è„šåˆå§‹åŒ–æ—¶ï¼Œ`network_type_`è¿˜æ˜¯é»˜è®¤å€¼`WIFI`
- âŒ å¤ä½å¼•è„šè¢«ç›´æŽ¥è®¾ç½®ä¸ºLOWï¼Œæ²¡æœ‰æ‰§è¡Œå¤ä½è„‰å†²ï¼ˆHIGH 100ms â†’ LOWï¼‰
- âŒ åŽæ¥åŠ è½½çš„ç½‘ç»œç±»åž‹æ˜¯`ML307`ï¼Œä½†å¤ä½æ—¶åºå·²ç»é”™è¿‡äº†
- âŒ ML307Rå¯èƒ½å¤„äºŽæœªå®šä¹‰çŠ¶æ€ï¼ŒUARTæœªåˆå§‹åŒ–ï¼Œæ— æ³•å“åº”ATæŒ‡ä»¤

### 5.2 ML307Rå¯åŠ¨æµç¨‹

**æ­£å¸¸å¯åŠ¨æµç¨‹**:
```
1. ä¸Šç”µ
2. å¤ä½å¼•è„šæ‹‰é«˜ï¼ˆå¤ä½çŠ¶æ€ï¼‰â†’ æŒç»­100ms
3. å¤ä½å¼•è„šæ‹‰ä½Žï¼ˆæ­£å¸¸å·¥ä½œï¼‰â†’ æ¨¡å—å¼€å§‹å¯åŠ¨
4. ç­‰å¾…3~5ç§’ â†’ æ¨¡å—å¯åŠ¨å®Œæˆ
5. å‘é€ATæŒ‡ä»¤ â†’ æ¨¡å—å“åº”"OK"
```

**å®žé™…æ‰§è¡Œæµç¨‹ï¼ˆä¿®å¤å‰ï¼‰**:
```
1. ä¸Šç”µ
2. å¤ä½å¼•è„šç›´æŽ¥è®¾ç½®ä¸ºLOWï¼ˆæ­£å¸¸å·¥ä½œï¼‰â†’ âŒ æ²¡æœ‰å¤ä½è„‰å†²
3. å‘é€ATæŒ‡ä»¤ â†’ âŒ æ¨¡å—æœªå“åº”
```

### 5.3 ä¸ºä»€ä¹ˆéœ€è¦å¤ä½è„‰å†²

- ML307Réœ€è¦**å¤ä½è„‰å†²**æ‰èƒ½ä»Žä¸Šç”µçŠ¶æ€è¿›å…¥æ­£å¸¸å·¥ä½œçŠ¶æ€
- ç›´æŽ¥å°†å¤ä½å¼•è„šè®¾ç½®ä¸ºLOWï¼Œæ¨¡å—å¯èƒ½å¤„äºŽ**æœªå®šä¹‰çŠ¶æ€**
- æ¨¡å—çš„UARTå¯èƒ½æœªåˆå§‹åŒ–ï¼Œæ— æ³•å“åº”ATæŒ‡ä»¤

---

## 6. ä¿®å¤æ–¹æ¡ˆ

### 6.1 ä¿®å¤æ€è·¯

**è°ƒæ•´æž„é€ å‡½æ•°çš„æ‰§è¡Œé¡ºåº**:
1. å…ˆåŠ è½½ç½‘ç»œç±»åž‹ï¼ˆ`LoadNetworkTypeFromSettings()`ï¼‰
2. å†æ ¹æ®ç½‘ç»œç±»åž‹åˆå§‹åŒ–å¤ä½å¼•è„š
3. å¦‚æžœæ˜¯ML307æ¨¡å¼ï¼Œæ‰§è¡Œå¤ä½æ—¶åºï¼ˆHIGH 100ms â†’ LOW â†’ ç­‰å¾…5ç§’ï¼‰
4. ç„¶åŽåˆå§‹åŒ–æ¿å¡å’Œå¼€å§‹æ£€æµ‹

### 6.2 ä¿®å¤ä»£ç 

**æ–‡ä»¶**: `main/boards/common/smart_dual_network_board.cc`

**ä¿®å¤åŽçš„ä»£ç **:

```cpp
SmartDualNetworkBoard::SmartDualNetworkBoard(gpio_num_t ml307_rst_pin, 
                                             gpio_num_t ml307_tx_pin, 
                                             gpio_num_t ml307_rx_pin, 
                                             gpio_num_t ml307_dtr_pin, 
                                             int32_t default_net_type) 
    : Board(), 
      ml307_rst_pin_(ml307_rst_pin),
      ml307_tx_pin_(ml307_tx_pin), 
      ml307_rx_pin_(ml307_rx_pin), 
      ml307_dtr_pin_(ml307_dtr_pin) {
    
    // ðŸŽ¯ å…³é”®ä¿®å¤ï¼šå…ˆåŠ è½½ç½‘ç»œç±»åž‹ï¼Œå†æ ¹æ®ç±»åž‹åˆå§‹åŒ–å¤ä½å¼•è„š
    network_type_ = LoadNetworkTypeFromSettings(default_net_type);
    
    // åˆå§‹åŒ–ML307å¤ä½å¼•è„š
    if (ml307_rst_pin_ != GPIO_NUM_NC) {
        gpio_reset_pin(ml307_rst_pin_);
        gpio_set_direction(ml307_rst_pin_, GPIO_MODE_OUTPUT);

        // ðŸŽ¯ æ ¹æ®åŠ è½½çš„ç½‘ç»œç±»åž‹æ‰§è¡Œç›¸åº”çš„å¤ä½æ—¶åº
        if (network_type_ == NetworkType::ML307) {
            ESP_LOGI(TAG, "ðŸ”§ ML307R Hardware Configuration:");
            ESP_LOGI(TAG, "   - Reset Pin: GPIO%d", ml307_rst_pin_);
            ESP_LOGI(TAG, "   - UART TX Pin: GPIO%d (ESP32 â†’ ML307R RX)", ml307_tx_pin_);
            ESP_LOGI(TAG, "   - UART RX Pin: GPIO%d (ESP32 â† ML307R TX)", ml307_rx_pin_);

            // æ‰§è¡Œå¤ä½æ—¶åºï¼šå…ˆé«˜ç”µå¹³å¤ä½100msï¼Œå†æ‹‰ä½Žæ¢å¤æ­£å¸¸
            gpio_set_level(ml307_rst_pin_, 1);  // é«˜ç”µå¹³å¤ä½
            ESP_LOGI(TAG, "ðŸ“Œ ML307 reset pin (GPIO%d) set to HIGH (resetting module)", ml307_rst_pin_);
            vTaskDelay(pdMS_TO_TICKS(100));

            gpio_set_level(ml307_rst_pin_, 0);  // ä½Žç”µå¹³ï¼Œæ¨¡å—æ­£å¸¸å·¥ä½œ
            ESP_LOGI(TAG, "ðŸ“Œ ML307 reset pin (GPIO%d) set to LOW (normal operation)", ml307_rst_pin_);

            // ç­‰å¾…æ¨¡å—å¯åŠ¨ï¼ˆML307Rå¯åŠ¨æ—¶é—´çº¦3-5ç§’ï¼‰
            ESP_LOGI(TAG, "â³ Waiting for ML307R module to boot (5 seconds)...");
            vTaskDelay(pdMS_TO_TICKS(5000));
            ESP_LOGI(TAG, "âœ… ML307R boot wait completed, starting UART detection...");
        } else {
            // WiFiæ¨¡å¼ä¸‹ï¼Œä¿æŒå¤ä½å¼•è„šä¸ºä½Žç”µå¹³ï¼ˆæ­£å¸¸å·¥ä½œçŠ¶æ€ï¼‰
            gpio_set_level(ml307_rst_pin_, 0);
            ESP_LOGI(TAG, "ML307 reset pin (GPIO%d) initialized to LOW (WiFi mode)", ml307_rst_pin_);
        }
    }
    
    // åˆå§‹åŒ–å½“å‰ç½‘ç»œç±»åž‹å¯¹åº”çš„æ¿å¡
    InitializeCurrentBoard();
    
    // å¯åŠ¨ç½‘ç»œç›‘æµ‹ä»»åŠ¡
    StartNetworkMonitor();
}
```

### 6.3 å…³é”®æ”¹è¿›ç‚¹

1. **âœ… æ‰§è¡Œé¡ºåºæ­£ç¡®**:
   - å…ˆåŠ è½½ç½‘ç»œç±»åž‹ï¼š`network_type_ = LoadNetworkTypeFromSettings(default_net_type);`
   - å†æ ¹æ®ç±»åž‹æ‰§è¡Œå¤ä½ï¼š`if (network_type_ == NetworkType::ML307)`
   - æœ€åŽåˆå§‹åŒ–æ¿å¡ï¼š`InitializeCurrentBoard();`

2. **âœ… å¤ä½æ—¶åºæ­£ç¡®**:
   - GPIO5å…ˆæ‹‰é«˜100msï¼ˆå¤ä½çŠ¶æ€ï¼‰
   - ç„¶åŽæ‹‰ä½Žï¼ˆæ­£å¸¸å·¥ä½œçŠ¶æ€ï¼‰
   - ç­‰å¾…5ç§’è®©æ¨¡å—å®Œå…¨å¯åŠ¨

3. **âœ… æ—¥å¿—æ›´è¯¦ç»†**:
   - æ˜¾ç¤ºç¡¬ä»¶é…ç½®ä¿¡æ¯
   - æ˜¾ç¤ºå¤ä½æ—¶åºçš„æ¯ä¸€æ­¥
   - æ˜¾ç¤ºå¯åŠ¨ç­‰å¾…è¿‡ç¨‹

---

## 7. éªŒè¯ç»“æžœ

### 7.1 ä¿®å¤åŽçš„å¯åŠ¨æ—¥å¿—

```
I (244) Board: UUID=7cbe9889-2602-4ce2-9127-c57560300802 SKU=lichuang-dev
I (244) gpio: GPIO[5]| InputEn: 0| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:0
I (244) SmartDualNetworkBoard: ðŸ”§ ML307R Hardware Configuration:
I (254) SmartDualNetworkBoard:    - Reset Pin: GPIO5
I (254) SmartDualNetworkBoard:    - UART TX Pin: GPIO17 (ESP32 â†’ ML307R RX)
I (264) SmartDualNetworkBoard:    - UART RX Pin: GPIO18 (ESP32 â† ML307R TX)
I (264) SmartDualNetworkBoard: ðŸ“Œ ML307 reset pin (GPIO5) set to HIGH (resetting module)
I (374) SmartDualNetworkBoard: ðŸ“Œ ML307 reset pin (GPIO5) set to LOW (normal operation)
I (374) SmartDualNetworkBoard: â³ Waiting for ML307R module to boot (5 seconds)...
I (5374) SmartDualNetworkBoard: âœ… ML307R boot wait completed, starting UART detection...
I (5374) SmartDualNetworkBoard: ðŸŒ Initialize ML307 4G board
I (5874) uart: queue free spaces: 100
I (5874) AtUart: Detecting baud rate...
I (5904) AtUart: Detected baud rate: 921600
I (5904) AtModem: Detected modem: ML307R-DL-MBRH0S01
I (5904) AtModem: Waiting for network ready...
I (5914) Ml307Board: Network is ready
I (5914) Ml307AtModem: PDP Context 1 IP: 10.155.22.225
I (5924) Ml307Board: ML307 Revision: ML307R-DL-MBRH0S01
I (5924) Ml307Board: ML307 IMEI: 862041074232258
I (5924) Ml307Board: ML307 ICCID: 89860812192380763362
I (5934) Application: STATE: activating
I (6024) Ml307Http: HTTP connection created, ID: 0, protocol: http, host: www.bysxai.com
I (6694) Ml307Http: HTTP request successful, status code: 200
I (6714) Ml307Http: HTTP connection closed, ID: 0
```

### 7.2 æ—¶åºåˆ†æž

| æ—¶é—´ç‚¹ | äº‹ä»¶ | è¯´æ˜Ž |
|--------|------|------|
| **244ms** | æ˜¾ç¤ºç¡¬ä»¶é…ç½® | GPIO5/17/18 |
| **264ms** | GPIO5 â†’ HIGH | å¼€å§‹å¤ä½ï¼ˆé«˜ç”µå¹³å¤ä½ï¼‰ |
| **374ms** | GPIO5 â†’ LOW | å¤ä½å®Œæˆï¼ˆä½Žç”µå¹³æ­£å¸¸å·¥ä½œï¼‰ |
| **374ms** | å¼€å§‹ç­‰å¾… | ç­‰å¾…5ç§’è®©æ¨¡å—å¯åŠ¨ |
| **5374ms** | ç­‰å¾…å®Œæˆ | å¼€å§‹UARTæ³¢ç‰¹çŽ‡æ£€æµ‹ |
| **5874ms** | å¼€å§‹æ£€æµ‹æ³¢ç‰¹çŽ‡ | å°è¯•8ç§æ³¢ç‰¹çŽ‡ |
| **5904ms** | âœ… æ£€æµ‹åˆ°æ³¢ç‰¹çŽ‡ï¼š921600 | åªç”¨äº†30mså°±æˆåŠŸï¼ |
| **5904ms** | âœ… æ£€æµ‹åˆ°æ¨¡å—åž‹å· | ML307R-DL-MBRH0S01 |
| **5914ms** | âœ… ç½‘ç»œå°±ç»ª | åªç”¨äº†10msï¼ |
| **5914ms** | âœ… èŽ·å¾—IPåœ°å€ | 10.155.22.225 |
| **5924ms** | âœ… è¯»å–æ¨¡å—ä¿¡æ¯ | IMEIã€ICCID |
| **6024ms** | âœ… HTTPè¿žæŽ¥åˆ›å»º | www.bysxai.com |
| **6694ms** | âœ… HTTPè¯·æ±‚æˆåŠŸ | çŠ¶æ€ç 200 |

**å¤ä½è„‰å†²æŒç»­æ—¶é—´**: 374ms - 264ms = 110ms âœ…ï¼ˆä»£ç è®¾ç½®100msï¼Œå®žé™…110msï¼Œæ­£å¸¸ï¼‰

**å¯åŠ¨ç­‰å¾…æ—¶é—´**: 5374ms - 374ms = 5000ms âœ…ï¼ˆæ­£å¥½5ç§’ï¼Œç¬¦åˆé¢„æœŸï¼‰

**æ³¢ç‰¹çŽ‡æ£€æµ‹æ—¶é—´**: 5904ms - 5874ms = 30ms âœ…ï¼ˆç¬¬ä¸€æ¬¡å°è¯•å°±æˆåŠŸï¼‰

### 7.3 ML307Ræ¨¡å—ä¿¡æ¯

| ä¿¡æ¯é¡¹ | å€¼ | è¯´æ˜Ž |
|--------|-----|------|
| **æ¨¡å—åž‹å·** | ML307R-DL-MBRH0S01 | ä¸­ç§»ç‰©è”ML307Ræ¨¡å— |
| **æ³¢ç‰¹çŽ‡** | 921600 | é«˜é€Ÿæ³¢ç‰¹çŽ‡ |
| **IMEI** | 862041074232258 | è®¾å¤‡å”¯ä¸€æ ‡è¯† |
| **ICCID** | 89860812192380763362 | SIMå¡å·ï¼ˆä¸­å›½ç§»åŠ¨ï¼‰ |
| **IPåœ°å€** | 10.155.22.225 | å†…ç½‘IPï¼ˆè¿è¥å•†åˆ†é…ï¼‰ |
| **ç½‘ç»œçŠ¶æ€** | Ready | å·²æ³¨å†Œå¹¶æ¿€æ´»æ•°æ®è¿žæŽ¥ |

### 7.4 åŠŸèƒ½éªŒè¯

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜Ž |
|------|------|------|
| å¤ä½æ—¶åº | âœ… æˆåŠŸ | HIGH 110ms â†’ LOW |
| æ³¢ç‰¹çŽ‡æ£€æµ‹ | âœ… æˆåŠŸ | æ£€æµ‹åˆ°921600 |
| æ¨¡å—è¯†åˆ« | âœ… æˆåŠŸ | ML307R-DL-MBRH0S01 |
| ç½‘ç»œæ³¨å†Œ | âœ… æˆåŠŸ | 10mså®Œæˆ |
| IPåœ°å€èŽ·å– | âœ… æˆåŠŸ | 10.155.22.225 |
| HTTPé€šä¿¡ | âœ… æˆåŠŸ | çŠ¶æ€ç 200 |

---

## 8. ç»éªŒæ€»ç»“

### 8.1 å…³é”®ç»éªŒ

1. **åˆå§‹åŒ–é¡ºåºå¾ˆé‡è¦**
   - åœ¨C++æž„é€ å‡½æ•°ä¸­ï¼Œæˆå‘˜å˜é‡çš„åˆå§‹åŒ–é¡ºåºä¼šå½±å“é€»è¾‘åˆ¤æ–­
   - åº”è¯¥å…ˆåŠ è½½é…ç½®ï¼Œå†æ ¹æ®é…ç½®æ‰§è¡Œç›¸åº”çš„åˆå§‹åŒ–é€»è¾‘
   - ä¸è¦ä¾èµ–æˆå‘˜å˜é‡çš„é»˜è®¤å€¼è¿›è¡Œé€»è¾‘åˆ¤æ–­

2. **ç¡¬ä»¶æ¨¡å—éœ€è¦æ­£ç¡®çš„å¯åŠ¨æ—¶åº**
   - ML307Réœ€è¦å¤ä½è„‰å†²æ‰èƒ½æ­£å¸¸å¯åŠ¨
   - ç›´æŽ¥è®¾ç½®å¤ä½å¼•è„šä¸ºå·¥ä½œçŠ¶æ€å¯èƒ½å¯¼è‡´æ¨¡å—å¤„äºŽæœªå®šä¹‰çŠ¶æ€
   - éœ€è¦ç­‰å¾…è¶³å¤Ÿçš„æ—¶é—´è®©æ¨¡å—å®Œå…¨å¯åŠ¨ï¼ˆ5ç§’ï¼‰

3. **æ—¥å¿—å¯¹è°ƒè¯•è‡³å…³é‡è¦**
   - è¯¦ç»†çš„æ—¥å¿—å¯ä»¥å¸®åŠ©å¿«é€Ÿå®šä½é—®é¢˜
   - æ—¥å¿—åº”è¯¥åŒ…å«å…³é”®çš„çŠ¶æ€ä¿¡æ¯å’Œæ—¶é—´æˆ³
   - é€šè¿‡æ—¥å¿—å¯ä»¥å‘çŽ°"WiFi mode"è¿™æ ·çš„å¼‚å¸¸æç¤º

4. **ç¤ºæ³¢å™¨æ˜¯ç¡¬ä»¶è°ƒè¯•çš„åˆ©å™¨**
   - é€šè¿‡ç¤ºæ³¢å™¨å¯ä»¥ç¡®è®¤ESP32çš„TXå¼•è„šæœ‰æ³¢å½¢ï¼ˆæŽ’é™¤è½¯ä»¶é—®é¢˜ï¼‰
   - é€šè¿‡ç¤ºæ³¢å™¨å¯ä»¥ç¡®è®¤ML307Rçš„TXå¼•è„šæ— æ³¢å½¢ï¼ˆå®šä½ç¡¬ä»¶é—®é¢˜ï¼‰
   - é€šè¿‡ç¤ºæ³¢å™¨å¯ä»¥éªŒè¯å¤ä½å¼•è„šçš„æ³¢å½¢æ˜¯å¦æ­£ç¡®

### 8.2 è°ƒè¯•æ–¹æ³•è®º

1. **åˆ†å±‚åˆ†æž**
   - ç¡¬ä»¶å±‚ï¼šå¼•è„šè¿žæŽ¥ã€ç”µæºã€å¤ä½é€»è¾‘
   - é©±åŠ¨å±‚ï¼šUARTé…ç½®ã€æ³¢ç‰¹çŽ‡æ£€æµ‹
   - åº”ç”¨å±‚ï¼šåˆå§‹åŒ–é¡ºåºã€é€»è¾‘åˆ¤æ–­

2. **å¯¹æ¯”åˆ†æž**
   - å¯¹æ¯”ä¿®å¤å‰åŽçš„æ—¥å¿—
   - å¯¹æ¯”é¢„æœŸè¡Œä¸ºå’Œå®žé™…è¡Œä¸º
   - å¯¹æ¯”ä»£ç é€»è¾‘å’Œæ‰§è¡Œç»“æžœ

3. **å·¥å…·è¾…åŠ©**
   - æ—¥å¿—åˆ†æžï¼šæŸ¥çœ‹æ—¶é—´æˆ³ã€çŠ¶æ€ä¿¡æ¯
   - ç¤ºæ³¢å™¨ï¼šéªŒè¯ç¡¬ä»¶ä¿¡å·
   - ä»£ç å®¡æŸ¥ï¼šæ£€æŸ¥é€»è¾‘é¡ºåº

### 8.3 é¢„é˜²æŽªæ–½

1. **ä»£ç å®¡æŸ¥**
   - åœ¨æž„é€ å‡½æ•°ä¸­ï¼Œæ³¨æ„æˆå‘˜å˜é‡çš„åˆå§‹åŒ–é¡ºåº
   - é¿å…åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ä¾èµ–æœªåˆå§‹åŒ–çš„æˆå‘˜å˜é‡
   - ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨æ˜Žç¡®åˆå§‹åŒ–é¡ºåº

2. **æµ‹è¯•éªŒè¯**
   - åœ¨ç¡¬ä»¶è¿žæŽ¥åŽï¼Œå…ˆç”¨ç¤ºæ³¢å™¨éªŒè¯ä¿¡å·
   - åœ¨è½¯ä»¶å¼€å‘æ—¶ï¼Œæ·»åŠ è¯¦ç»†çš„æ—¥å¿—
   - åœ¨é›†æˆæµ‹è¯•æ—¶ï¼ŒéªŒè¯å„ç§æ¨¡å¼çš„åˆ‡æ¢

3. **æ–‡æ¡£è®°å½•**
   - è®°å½•ç¡¬ä»¶è¿žæŽ¥å›¾å’Œå¼•è„šå®šä¹‰
   - è®°å½•æ¨¡å—çš„å¯åŠ¨æ—¶åºè¦æ±‚
   - è®°å½•è°ƒè¯•è¿‡ç¨‹å’Œè§£å†³æ–¹æ¡ˆ

---

## é™„å½•

### A. ç›¸å…³æ–‡ä»¶åˆ—è¡¨

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜Ž |
|---------|------|
| `main/boards/lichuang-dev/config.h` | ç¡¬ä»¶å¼•è„šé…ç½® |
| `main/boards/common/smart_dual_network_board.h` | æ™ºèƒ½åŒç½‘ç»œæ¿å¡å¤´æ–‡ä»¶ |
| `main/boards/common/smart_dual_network_board.cc` | æ™ºèƒ½åŒç½‘ç»œæ¿å¡å®žçŽ°ï¼ˆä¿®å¤æ–‡ä»¶ï¼‰ |
| `main/boards/lichuang-dev/lichuang_dev_board.cc` | ç«‹åˆ›å¼€å‘æ¿ä¸»æ–‡ä»¶ |
| `managed_components/78__esp-ml307/src/at_uart.cc` | AT UARTé€šä¿¡å±‚ |
| `managed_components/78__esp-ml307/src/at_modem.cc` | AT ModemåŸºç¡€åŠŸèƒ½ |
| `managed_components/78__esp-ml307/src/ml307/ml307_at_modem.cc` | ML307Rç‰¹å®šåŠŸèƒ½ |

### B. å‚è€ƒèµ„æ–™

- ESP-IDF UARTé©±åŠ¨æ–‡æ¡£
- ML307R ATæŒ‡ä»¤æ‰‹å†Œ
- ML307Rç¡¬ä»¶è®¾è®¡æ‰‹å†Œ
- FreeRTOSä»»åŠ¡è°ƒåº¦æ–‡æ¡£

### C. ä¿®å¤å‰åŽå¯¹æ¯”

#### C.1 ä»£ç æ‰§è¡Œæµç¨‹å¯¹æ¯”

**ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰**:
```
æž„é€ å‡½æ•°å¼€å§‹
  â†“
åˆå§‹åŒ–æˆå‘˜å˜é‡ï¼ˆnetwork_type_ = WIFIï¼Œé»˜è®¤å€¼ï¼‰
  â†“
åˆ¤æ–­ï¼šif (network_type_ == NetworkType::ML307)
  â†“
ç»“æžœï¼šfalseï¼ˆå› ä¸ºnetwork_type_æ˜¯WIFIï¼‰
  â†“
æ‰§è¡Œï¼šgpio_set_level(ml307_rst_pin_, 0);  // ç›´æŽ¥è®¾ç½®ä¸ºLOW
  â†“
æ—¥å¿—ï¼šML307 reset pin (GPIO5) initialized to LOW (WiFi mode)
  â†“
åŠ è½½ç½‘ç»œç±»åž‹ï¼šnetwork_type_ = LoadNetworkTypeFromSettings(...)
  â†“
ç»“æžœï¼šnetwork_type_ = ML307ï¼ˆä½†å¤ä½æ—¶åºå·²ç»é”™è¿‡ï¼‰
  â†“
åˆå§‹åŒ–æ¿å¡ï¼šInitializeCurrentBoard()
  â†“
å¼€å§‹æ³¢ç‰¹çŽ‡æ£€æµ‹ï¼šAtUart::DetectBaudRate()
  â†“
âŒ å¤±è´¥ï¼šML307Ræœªå“åº”ï¼ˆå› ä¸ºæ²¡æœ‰å¤ä½è„‰å†²ï¼‰
```

**ä¿®å¤åŽï¼ˆæ­£ç¡®ï¼‰**:
```
æž„é€ å‡½æ•°å¼€å§‹
  â†“
åˆå§‹åŒ–æˆå‘˜å˜é‡ï¼ˆnetwork_type_ = WIFIï¼Œé»˜è®¤å€¼ï¼‰
  â†“
åŠ è½½ç½‘ç»œç±»åž‹ï¼šnetwork_type_ = LoadNetworkTypeFromSettings(...)
  â†“
ç»“æžœï¼šnetwork_type_ = ML307
  â†“
åˆ¤æ–­ï¼šif (network_type_ == NetworkType::ML307)
  â†“
ç»“æžœï¼štrueï¼ˆå› ä¸ºnetwork_type_å·²ç»æ˜¯ML307ï¼‰
  â†“
æ‰§è¡Œå¤ä½æ—¶åºï¼š
  - gpio_set_level(ml307_rst_pin_, 1);  // é«˜ç”µå¹³å¤ä½
  - vTaskDelay(100ms);
  - gpio_set_level(ml307_rst_pin_, 0);  // ä½Žç”µå¹³æ­£å¸¸å·¥ä½œ
  - vTaskDelay(5000ms);  // ç­‰å¾…å¯åŠ¨
  â†“
æ—¥å¿—ï¼šâœ… ML307R boot wait completed, starting UART detection...
  â†“
åˆå§‹åŒ–æ¿å¡ï¼šInitializeCurrentBoard()
  â†“
å¼€å§‹æ³¢ç‰¹çŽ‡æ£€æµ‹ï¼šAtUart::DetectBaudRate()
  â†“
âœ… æˆåŠŸï¼šDetected baud rate: 921600ï¼ˆ30mså†…æˆåŠŸï¼‰
```

#### C.2 æ—¥å¿—å¯¹æ¯”

| é˜¶æ®µ | ä¿®å¤å‰ | ä¿®å¤åŽ |
|------|--------|--------|
| å¤ä½å¼•è„šåˆå§‹åŒ– | `ML307 reset pin (GPIO5) initialized to LOW (WiFi mode)` | `ðŸ“Œ ML307 reset pin (GPIO5) set to HIGH (resetting module)` |
| å¤ä½å®Œæˆ | æ—  | `ðŸ“Œ ML307 reset pin (GPIO5) set to LOW (normal operation)` |
| å¯åŠ¨ç­‰å¾… | æ—  | `â³ Waiting for ML307R module to boot (5 seconds)...` |
| ç­‰å¾…å®Œæˆ | æ—  | `âœ… ML307R boot wait completed, starting UART detection...` |
| æ³¢ç‰¹çŽ‡æ£€æµ‹ | `Detecting baud rate...`ï¼ˆæ¯1160msé‡å¤ï¼‰ | `Detected baud rate: 921600`ï¼ˆ30msæˆåŠŸï¼‰ |
| æ¨¡å—è¯†åˆ« | æ—  | `Detected modem: ML307R-DL-MBRH0S01` |
| ç½‘ç»œçŠ¶æ€ | æ—  | `Network is ready` |
| IPåœ°å€ | æ—  | `PDP Context 1 IP: 10.155.22.225` |

#### C.3 æ—¶é—´çº¿å¯¹æ¯”

**ä¿®å¤å‰**:
```
0ms     â”€â”€â”€ ç³»ç»Ÿå¯åŠ¨
239ms   â”€â”€â”€ GPIO5è®¾ç½®ä¸ºLOWï¼ˆé”™è¯¯ï¼‰
249ms   â”€â”€â”€ åˆå§‹åŒ–ML307æ¿å¡
759ms   â”€â”€â”€ å¼€å§‹æ³¢ç‰¹çŽ‡æ£€æµ‹
1919ms  â”€â”€â”€ æ³¢ç‰¹çŽ‡æ£€æµ‹å¤±è´¥ï¼Œé‡è¯•
3079ms  â”€â”€â”€ æ³¢ç‰¹çŽ‡æ£€æµ‹å¤±è´¥ï¼Œé‡è¯•
...     â”€â”€â”€ æ— é™å¾ªçŽ¯
```

**ä¿®å¤åŽ**:
```
0ms     â”€â”€â”€ ç³»ç»Ÿå¯åŠ¨
244ms   â”€â”€â”€ æ˜¾ç¤ºç¡¬ä»¶é…ç½®
264ms   â”€â”€â”€ GPIO5è®¾ç½®ä¸ºHIGHï¼ˆå¤ä½å¼€å§‹ï¼‰
374ms   â”€â”€â”€ GPIO5è®¾ç½®ä¸ºLOWï¼ˆå¤ä½å®Œæˆï¼‰
5374ms  â”€â”€â”€ ç­‰å¾…5ç§’å®Œæˆ
5874ms  â”€â”€â”€ å¼€å§‹æ³¢ç‰¹çŽ‡æ£€æµ‹
5904ms  â”€â”€â”€ âœ… æ³¢ç‰¹çŽ‡æ£€æµ‹æˆåŠŸï¼ˆ921600ï¼‰
5914ms  â”€â”€â”€ âœ… ç½‘ç»œå°±ç»ª
6024ms  â”€â”€â”€ âœ… HTTPè¿žæŽ¥åˆ›å»º
6694ms  â”€â”€â”€ âœ… HTTPè¯·æ±‚æˆåŠŸ
```

### D. æŠ€æœ¯ç»†èŠ‚

#### D.1 ML307Rå¤ä½é€»è¾‘

**å¤ä½å¼•è„šï¼ˆRESETï¼‰**:
- **é«˜ç”µå¹³ï¼ˆ1ï¼‰**: å¤ä½çŠ¶æ€ï¼Œæ¨¡å—å†…éƒ¨é€»è¾‘è¢«å¤ä½
- **ä½Žç”µå¹³ï¼ˆ0ï¼‰**: æ­£å¸¸å·¥ä½œçŠ¶æ€ï¼Œæ¨¡å—æ­£å¸¸è¿è¡Œ

**å¤ä½æ—¶åºè¦æ±‚**:
- å¤ä½è„‰å†²å®½åº¦ï¼šâ‰¥100ms
- å¤ä½åŽå¯åŠ¨æ—¶é—´ï¼š3~5ç§’
- å¤ä½æœŸé—´UARTä¸å“åº”

#### D.2 æ³¢ç‰¹çŽ‡è‡ªåŠ¨æ£€æµ‹åŽŸç†

**æ£€æµ‹æ–¹æ³•**:
1. ä¾æ¬¡å°è¯•8ç§å¸¸è§æ³¢ç‰¹çŽ‡
2. æ¯ç§æ³¢ç‰¹çŽ‡å‘é€`AT\r\n`å‘½ä»¤
3. ç­‰å¾…20msæŽ¥æ”¶å“åº”
4. å¦‚æžœæ”¶åˆ°`OK\r\n`ï¼Œæ£€æµ‹æˆåŠŸ
5. å¦‚æžœæ‰€æœ‰æ³¢ç‰¹çŽ‡éƒ½å¤±è´¥ï¼Œç­‰å¾…1ç§’åŽé‡è¯•

**ä¸ºä»€ä¹ˆML307Rçš„æ³¢ç‰¹çŽ‡æ˜¯921600**:
- ML307Rå‡ºåŽ‚é»˜è®¤æ³¢ç‰¹çŽ‡æ˜¯921600ï¼ˆé«˜é€Ÿæ¨¡å¼ï¼‰
- è¿™æ˜¯8ç§å°è¯•æ³¢ç‰¹çŽ‡ä¸­çš„ç¬¬äºŒä¸ª
- æ£€æµ‹æˆåŠŸæ—¶é—´ï¼š20msï¼ˆç¬¬ä¸€ä¸ª115200å¤±è´¥ï¼‰+ 10msï¼ˆç¬¬äºŒä¸ª921600æˆåŠŸï¼‰= 30ms

#### D.3 UARTé€šä¿¡å‚æ•°

**ESP32ä¾§é…ç½®**:
```c
uart_config_t uart_config = {
    .baud_rate = 921600,              // æ³¢ç‰¹çŽ‡ï¼ˆè‡ªåŠ¨æ£€æµ‹åŽè®¾ç½®ï¼‰
    .data_bits = UART_DATA_8_BITS,    // 8ä½æ•°æ®ä½
    .parity = UART_PARITY_DISABLE,    // æ— æ ¡éªŒ
    .stop_bits = UART_STOP_BITS_1,    // 1ä½åœæ­¢ä½
    .flow_ctrl = UART_HW_FLOWCTRL_DISABLE,  // æ— ç¡¬ä»¶æµæŽ§
    .source_clk = UART_SCLK_DEFAULT,  // é»˜è®¤æ—¶é’Ÿæº
};
```

**ML307Rä¾§é…ç½®**:
- é»˜è®¤æ³¢ç‰¹çŽ‡ï¼š921600
- æ•°æ®æ ¼å¼ï¼š8N1ï¼ˆ8ä½æ•°æ®ä½ï¼Œæ— æ ¡éªŒï¼Œ1ä½åœæ­¢ä½ï¼‰
- æµæŽ§ï¼šæ— 

#### D.4 ç½‘ç»œæ³¨å†Œæµç¨‹

**ML307Rç½‘ç»œæ³¨å†Œæ­¥éª¤**:
1. SIMå¡æ£€æµ‹ï¼ˆè‡ªåŠ¨ï¼‰
2. ç½‘ç»œæœç´¢ï¼ˆè‡ªåŠ¨ï¼‰
3. ç½‘ç»œæ³¨å†Œï¼ˆè‡ªåŠ¨ï¼‰
4. PDPä¸Šä¸‹æ–‡æ¿€æ´»ï¼ˆè‡ªåŠ¨ï¼‰
5. IPåœ°å€åˆ†é…ï¼ˆè‡ªåŠ¨ï¼‰

**ä»Žæ—¥å¿—çœ‹ï¼Œæ•´ä¸ªè¿‡ç¨‹åªç”¨äº†10ms**:
```
I (5904) AtModem: Waiting for network ready...
I (5914) Ml307Board: Network is ready
```

è¿™è¯´æ˜ŽML307Råœ¨å¤ä½å¯åŠ¨çš„5ç§’å†…ï¼Œå·²ç»å®Œæˆäº†æ‰€æœ‰ç½‘ç»œæ³¨å†Œæ­¥éª¤ï¼Œåªæ˜¯åœ¨ç­‰å¾…è½¯ä»¶æŸ¥è¯¢ã€‚

### E. æ•…éšœæŽ’æŸ¥æ¸…å•

å¦‚æžœé‡åˆ°ç±»ä¼¼é—®é¢˜ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ¸…å•æŽ’æŸ¥ï¼š

#### E.1 ç¡¬ä»¶æ£€æŸ¥

- [ ] ç”µæºç”µåŽ‹æ˜¯å¦æ­£å¸¸ï¼ˆ3.3V~4.2Vï¼‰
- [ ] ç”µæºç”µæµæ˜¯å¦è¶³å¤Ÿï¼ˆå³°å€¼2Aï¼‰
- [ ] TX/RXå¼•è„šæ˜¯å¦æŽ¥å
- [ ] å¤ä½å¼•è„šæ˜¯å¦è¿žæŽ¥æ­£ç¡®
- [ ] SIMå¡æ˜¯å¦æ’å…¥å¹¶æ¿€æ´»

#### E.2 è½¯ä»¶æ£€æŸ¥

- [ ] å¤ä½æ—¶åºæ˜¯å¦æ­£ç¡®æ‰§è¡Œ
- [ ] å¤ä½åŽæ˜¯å¦ç­‰å¾…è¶³å¤Ÿçš„å¯åŠ¨æ—¶é—´ï¼ˆ5ç§’ï¼‰
- [ ] UARTé…ç½®æ˜¯å¦æ­£ç¡®ï¼ˆæ³¢ç‰¹çŽ‡ã€æ•°æ®ä½ã€åœæ­¢ä½ï¼‰
- [ ] æ³¢ç‰¹çŽ‡æ£€æµ‹æ˜¯å¦åŒ…å«æ¨¡å—çš„é»˜è®¤æ³¢ç‰¹çŽ‡
- [ ] åˆå§‹åŒ–é¡ºåºæ˜¯å¦æ­£ç¡®

#### E.3 æ—¥å¿—æ£€æŸ¥

- [ ] æ˜¯å¦æœ‰å¤ä½å¼•è„šçš„æ—¥å¿—
- [ ] å¤ä½å¼•è„šçš„ç”µå¹³æ˜¯å¦æ­£ç¡®
- [ ] æ˜¯å¦æœ‰"Detecting baud rate..."æ—¥å¿—
- [ ] æ˜¯å¦æœ‰"Detected baud rate: xxx"æ—¥å¿—
- [ ] æ˜¯å¦æœ‰"Detected modem: xxx"æ—¥å¿—
- [ ] æ˜¯å¦æœ‰"Network is ready"æ—¥å¿—

#### E.4 ç¤ºæ³¢å™¨æ£€æŸ¥

- [ ] å¤ä½å¼•è„šæ˜¯å¦æœ‰è„‰å†²æ³¢å½¢ï¼ˆHIGH 100ms â†’ LOWï¼‰
- [ ] ESP32çš„TXå¼•è„šæ˜¯å¦æœ‰æ³¢å½¢ï¼ˆå‘é€ATæŒ‡ä»¤ï¼‰
- [ ] ML307Rçš„TXå¼•è„šæ˜¯å¦æœ‰æ³¢å½¢ï¼ˆå“åº”ATæŒ‡ä»¤ï¼‰
- [ ] æ³¢å½¢çš„æ³¢ç‰¹çŽ‡æ˜¯å¦æ­£ç¡®

### F. å¸¸è§é—®é¢˜FAQ

**Q1: ä¸ºä»€ä¹ˆå¤ä½å¼•è„šè¦å…ˆæ‹‰é«˜å†æ‹‰ä½Žï¼Ÿ**

A: ML307Rçš„å¤ä½å¼•è„šæ˜¯é«˜ç”µå¹³å¤ä½ã€‚æ‹‰é«˜è¡¨ç¤ºè¿›å…¥å¤ä½çŠ¶æ€ï¼Œæ‹‰ä½Žè¡¨ç¤ºé€€å‡ºå¤ä½çŠ¶æ€å¹¶å¼€å§‹æ­£å¸¸å·¥ä½œã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º"å¤ä½è„‰å†²"ã€‚

**Q2: ä¸ºä»€ä¹ˆè¦ç­‰å¾…5ç§’ï¼Ÿ**

A: ML307Råœ¨å¤ä½åŽéœ€è¦æ—¶é—´æ¥åˆå§‹åŒ–å†…éƒ¨é€»è¾‘ã€æ£€æµ‹SIMå¡ã€æœç´¢ç½‘ç»œã€æ³¨å†Œç½‘ç»œç­‰ã€‚æ ¹æ®æ•°æ®æ‰‹å†Œï¼Œè¿™ä¸ªè¿‡ç¨‹éœ€è¦3~5ç§’ã€‚

**Q3: ä¸ºä»€ä¹ˆæ³¢ç‰¹çŽ‡æ£€æµ‹è¦å°è¯•8ç§ï¼Ÿ**

A: å› ä¸ºä¸åŒçš„æ¨¡å—å¯èƒ½æœ‰ä¸åŒçš„é»˜è®¤æ³¢ç‰¹çŽ‡ã€‚é€šè¿‡å°è¯•å¤šç§å¸¸è§æ³¢ç‰¹çŽ‡ï¼Œå¯ä»¥è‡ªåŠ¨é€‚é…ä¸åŒçš„æ¨¡å—ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®ã€‚

**Q4: å¦‚æžœç¤ºæ³¢å™¨æ˜¾ç¤ºTXå¼•è„šæœ‰æ³¢å½¢ï¼Œä½†RXå¼•è„šæ— æ³¢å½¢ï¼Œè¯´æ˜Žä»€ä¹ˆï¼Ÿ**

A: è¯´æ˜ŽESP32æ­£åœ¨å‘é€ATæŒ‡ä»¤ï¼Œä½†æ¨¡å—æ²¡æœ‰å“åº”ã€‚å¯èƒ½çš„åŽŸå› ï¼š
- æ¨¡å—æœªå¯åŠ¨ï¼ˆå¤ä½æ—¶åºé”™è¯¯ã€ç”µæºé—®é¢˜ï¼‰
- æ³¢ç‰¹çŽ‡ä¸åŒ¹é…
- TX/RXå¼•è„šæŽ¥å
- æ¨¡å—æŸå

**Q5: ä¸ºä»€ä¹ˆä¿®å¤å‰æ—¥å¿—æ˜¾ç¤º"WiFi mode"ï¼Ÿ**

A: å› ä¸ºåœ¨åˆå§‹åŒ–å¤ä½å¼•è„šæ—¶ï¼Œ`network_type_`è¿˜æ˜¯é»˜è®¤å€¼`WIFI`ã€‚ä»£ç åˆ¤æ–­`if (network_type_ == NetworkType::ML307)`ä¸ºfalseï¼Œæ‰€ä»¥æ‰§è¡Œäº†elseåˆ†æ”¯ï¼Œæ—¥å¿—æ˜¾ç¤º"WiFi mode"ã€‚è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„è°ƒè¯•çº¿ç´¢ï¼Œè¯´æ˜Žæ‰§è¡Œé¡ºåºæœ‰é—®é¢˜ã€‚

**Q6: ML307Rçš„IMEIå’ŒICCIDæœ‰ä»€ä¹ˆç”¨ï¼Ÿ**

A:
- **IMEI**ï¼ˆInternational Mobile Equipment Identityï¼‰ï¼šè®¾å¤‡å”¯ä¸€æ ‡è¯†ï¼Œç±»ä¼¼äºŽæ‰‹æœºçš„åºåˆ—å·
- **ICCID**ï¼ˆIntegrated Circuit Card Identifierï¼‰ï¼šSIMå¡å·ï¼Œç”¨äºŽè¯†åˆ«SIMå¡

è¿™äº›ä¿¡æ¯å¯ä»¥ç”¨äºŽè®¾å¤‡ç®¡ç†ã€ç½‘ç»œè®¤è¯ã€æ•…éšœæŽ’æŸ¥ç­‰ã€‚

**Q7: ä¸ºä»€ä¹ˆç½‘ç»œå°±ç»ªåªç”¨äº†10msï¼Ÿ**

A: å› ä¸ºML307Råœ¨å¤ä½å¯åŠ¨çš„5ç§’å†…ï¼Œå·²ç»è‡ªåŠ¨å®Œæˆäº†ç½‘ç»œæ³¨å†Œã€‚è½¯ä»¶åªæ˜¯æŸ¥è¯¢ç½‘ç»œçŠ¶æ€ï¼Œæ‰€ä»¥å¾ˆå¿«å°±å¾—åˆ°äº†"å·²å°±ç»ª"çš„ç»“æžœã€‚

**Q8: å¦‚æžœæ²¡æœ‰ç¤ºæ³¢å™¨æ€Žä¹ˆåŠžï¼Ÿ**

A: å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•è°ƒè¯•ï¼š
- æ·»åŠ è¯¦ç»†çš„æ—¥å¿—ï¼Œè§‚å¯Ÿæ‰§è¡Œæµç¨‹
- ä½¿ç”¨ä¸‡ç”¨è¡¨æµ‹é‡ç”µåŽ‹ï¼ˆè™½ç„¶æ— æ³•çœ‹åˆ°æ³¢å½¢ï¼Œä½†å¯ä»¥ç¡®è®¤ç”µå¹³ï¼‰
- ä½¿ç”¨é€»è¾‘åˆ†æžä»ªï¼ˆæ¯”ç¤ºæ³¢å™¨ä¾¿å®œï¼‰
- ä½¿ç”¨USBè½¬TTLæ¨¡å—æ‰‹åŠ¨æµ‹è¯•æ¨¡å—

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åŽæ›´æ–°**: 2025-11-12
**ä½œè€…**: AI Assistant
**å®¡æ ¸**: å¾…å®¡æ ¸

---

**æ–‡æ¡£ç»“æŸ**

